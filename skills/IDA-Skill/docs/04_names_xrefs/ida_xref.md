# ida_xref

Functions that deal with cross-references (xrefs).

There are 2 groups of xrefs: CODE and DATA references. All xrefs are kept in the bTree except the ordinary execution flow to the next instruction. The ordinary execution flow to the next instruction is kept in flags (see bytes.hpp)

The source address of an xref must be an item head (is_head) or a structure member id. Even if an xref is generated by an element in the middle of the item, the item head address must be used. There are some exceptions to the rule but they are not worth mentioning here.

Xrefs are automatically sorted by addresses. However, the flow to the next instruction is always at the beginning of the list.

Xrefs are usually created by the processor module, as a reaction to the ev_emu_insn event. Plugins may create xrefs too but please note that upon a reanalysis of an item, all its xrefs, except the ones marked with XREF_USER, are deleted by the kernel.

## Constants

- `fl_U`: unknown - for compatibility with old versions. Should not be used anymore.
- `fl_CF`: Call Far This xref creates a function at the referenced location
- `fl_CN`: Call Near This xref creates a function at the referenced location
- `fl_JF`: Jump Far.
- `fl_JN`: Jump Near.
- `fl_USobsolete`: User specified (obsolete)
- `fl_F`: Ordinary flow: used to specify execution flow to the next instruction.
- `dr_U`: Unknown - for compatibility with old versions. Should not be used anymore.
- `dr_O`: Offset The reference uses 'offset' of data rather than its value OR The reference appeared because the "OFFSET" flag of instruction is set. The meaning of this type is IDP dependent.
- `dr_W`: Write access.
- `dr_R`: Read access.
- `dr_T`: Text (for forced operands only) Name of data is used in manual operand
- `dr_I`: Informational (a derived java class references its base class informationally)
- `dr_S`: Reference to enum member (symbolic constant)
- `XREF_USER`: User specified xref. This xref will not be deleted by IDA. This bit should be combined with the existing xref types (cref_t & dref_t) Cannot be used for fl_F xrefs
- `XREF_TAIL`: Reference to tail byte in extrn symbols.
- `XREF_BASE`: Reference to the base part of an offset.
- `XREF_MASK`: Mask to get xref type.
- `XREF_PASTEND`: Reference is past item. This bit may be passed to add_dref() functions but it won't be saved in the database. It will prevent the destruction of eventual alignment directives.
- `XREF_FLOW`: return all references, including ordinary flow xrefs
- `XREF_NOFLOW`: skip ordinary flow xrefs (code xrefs to the next insn)
- `XREF_DATA`: return only data references (dr_...)
- `XREF_CODE`: return only code references (fl_...)
- `XREF_EA`: return only program addresses
- `XREF_TID`: return only type ids. XREF_EA and XREF_TID are exclusive, only one of them can be specified
- `XREF_ALL`
- `XREF_FAR`
- `XREF_ALL`
- `XREF_FAR`

## Classes Overview

- `cases_and_targets_t`
- `xrefblk_t`
- `casevec_t`

## Functions Overview

- `create_switch_xrefs(ea, si)`: This function creates xrefs from the indirect jump.
- `calc_switch_cases(ea, si)`: Get information about a switch's cases.
- `create_switch_table(ea, si)`: Create switch table from the switch information
- `xrefchar(xrtype: char) -> char`: Get character describing the xref type.
- `add_cref(frm: ida_idaapi.ea_t, to: ida_idaapi.ea_t, type: cref_t) -> bool`: Create a code cross-reference.
- `del_cref(frm: ida_idaapi.ea_t, to: ida_idaapi.ea_t, expand: bool) -> bool`: Delete a code cross-reference.
- `add_dref(frm: ida_idaapi.ea_t, to: ida_idaapi.ea_t, type: dref_t) -> bool`: Create a data cross-reference.
- `del_dref(frm: ida_idaapi.ea_t, to: ida_idaapi.ea_t) -> None`: Delete a data cross-reference.
- `get_first_dref_from(frm: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get first data referenced from the specified address.
- `get_next_dref_from(frm: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get next data referenced from the specified address.
- `get_first_dref_to(to: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get address of instruction/data referencing to the specified data.
- `get_next_dref_to(to: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get address of instruction/data referencing to the specified data
- `get_first_cref_from(frm: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get first instruction referenced from the specified instruction. If the specified instruction passes execution to the next instruction then the next instruction is returned. Otherwise the lowest referenced address is returned (remember that xrefs are kept sorted!).
- `get_next_cref_from(frm: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get next instruction referenced from the specified instruction.
- `get_first_cref_to(to: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get first instruction referencing to the specified instruction. If the specified instruction may be executed immediately after its previous instruction then the previous instruction is returned. Otherwise the lowest referencing address is returned. (remember that xrefs are kept sorted!).
- `get_next_cref_to(to: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`: Get next instruction referencing to the specified instruction.
- `get_first_fcref_from(frm: ida_idaapi.ea_t) -> ida_idaapi.ea_t`
- `get_next_fcref_from(frm: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`
- `get_first_fcref_to(to: ida_idaapi.ea_t) -> ida_idaapi.ea_t`
- `get_next_fcref_to(to: ida_idaapi.ea_t, current: ida_idaapi.ea_t) -> ida_idaapi.ea_t`
- `has_external_refs(pfn: func_t *, ea: ida_idaapi.ea_t) -> bool`: Does 'ea' have references from outside of 'pfn'?
- `has_jump_or_flow_xref(ea: ida_idaapi.ea_t) -> bool`: Are there jump or flow references to EA?
- `delete_switch_table(jump_ea: ida_idaapi.ea_t, si: switch_info_t) -> None`