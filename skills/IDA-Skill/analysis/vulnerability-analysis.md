# 漏洞分析

本文档提供漏洞挖掘和分析的思路和关键 API。

## 攻击面识别

| 目标 | 方法 | 关键 API |
|------|------|----------|
| 定位输入点 | 找 recv/fread/scanf 调用 | `idc.get_name_ea_simple()`, `idautils.XrefsTo()` |
| 定位危险函数 | 找 strcpy/sprintf/memcpy 调用 | 同上 |
| 追踪数据流 | 反编译分析参数传递 | `ida_hexrays.decompile()` |

## 内存安全漏洞

| 目标 | 方法 | 关键 API |
|------|------|----------|
| 栈溢出 | 找无边界检查的 strcpy/gets/sprintf | `idautils.XrefsTo()`, `ida_frame.get_frame()` |
| 堆溢出 | 找 malloc 后的 memcpy 无长度校验 | `ida_hexrays.decompile()` 分析参数 |
| 格式化字符串 | 找 printf/sprintf 用户可控参数 | `idautils.XrefsTo()` |
| UAF | 追踪 free 后的指针使用 | `ida_hexrays.decompile()` |
| 整数溢出 | 找乘法/加法后用于分配大小 | `ida_hexrays.decompile()` |

## 逻辑漏洞

| 目标 | 方法 | 关键 API |
|------|------|----------|
| 认证绕过 | 分析登录/权限检查函数 | `ida_hexrays.decompile()` |
| 条件竞争 | 找 TOCTOU 模式（检查后使用） | `idautils.XrefsTo()` 分析文件操作 |
| 命令注入 | 找 system/popen/exec 调用 | `idautils.XrefsTo()` |
